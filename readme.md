# 电梯调度系统

CPU调度是多道程序操作系统的基础。了解操作系统在进程/线程间进行的CPU调度是了解操作系统的重要部分。对于调度系统，电梯的调度系统是较为典型而常见的例子。本例通过实现电梯调度程序，探究调度程序的运作方式。



## 项目分析

### 项目背景

​	某栋楼共有20层（约定楼层编号为1…20），楼内共有五部互联（即统一调度，在电梯外对一个电梯下指令时，指令可能调度到任意电梯）的电梯。基于线程的思想，编写电梯调度程序。



### 项目目的

- 学习调度算法
- 通过实现电梯调度的功能，体会操作系统调度过程
- 学习特定环境下多线程编程的方法



### 功能需求

- 模拟电梯内部的功能键与状态显示：数字楼层键、上升及下降状态、报警键、当前楼层数
- 模拟电梯外部功能：上行、下行按键、电梯楼层显示
- 其他功能：
  - 所有电梯外部按钮互联
  - 所有电梯初始状态在第一层
  - 每个电梯在上层/下层没有相应请求的状况下，应该在原地保持不动



## 开发工具

- 开发语言：C/C++
- 图形界面框架：Qt5
- 开发工具：CLion Professional + CMake



## 术语表

| 术语     | 含义                                                         |
| -------- | ------------------------------------------------------------ |
| 请求     | 指经过电梯内外的控制面板发送的，用户对电梯运行的指示。包含内部请求，即由电梯内面板发送的仅包含楼层信息的请求，与外部请求，即电梯外面板发送的，包含楼层与方向信息的请求。 |
| 调度     | 指程序中运行的一系列算法，统一处理各个请求，并将请求合理地发送给一步电梯形成任务，或挂起这个请求等待稍后进行调度。 |
| 任务     | 当一个请求由调度程序发给特定电梯时，即成为该电梯的任务。     |
| 电梯     | 指电梯的实体，包含电梯当前的运行状态（运行方向，是否停止，所在楼层，是否处于警报状态）以及特定电梯实体维护的在调度过程中收到的任务。 |
| 运行逻辑 | 指对于单个电梯而言，依据所保存的收到的任务信息与自身当前的状态，对接下来的状态进行调整的算法。 |
| 优先级   | 对于某一请求和一特定的电梯，若请求的楼层在电梯运行方向上，则优先级为电梯当前楼层到请求的楼层的距离（优先级越大，优先级别越高），若方向相反，则优先级视为不存在。 |
| 挂起     | 若调度程序收到某一请求时，所有电梯对其优先级均不存在，则该请求被暂缓调度。 |
| 挂起队列 | 保存所有挂起的请求信息的队列。                               |
| 重调度   | 在某一电梯的状态发生改变，满足：电梯停止或电梯运行方向与挂起队列队首请求相同时，对挂起队列中所有请求重新运行调度算法的过程。 |



## 设计

在本项目中，由于电梯多于一部，调度部分主要需要实现接受不同的内部/外部请求，并通过特定的算法将请求的任务分发至某个电梯。而对于某一特定的电梯，需要保存收到的任务，并建立一定的运行逻辑，达到高效地完成收到任务的目的。



### 调度算法

考虑到现实中电梯的运行情况，为缩短每个请求成为任务的时间，本系统采用以优先级为标准的调度算法。同时为了减少产生饥饿的可能，对挂起的请求进行FIFO的管理，使得先被挂起的请求倾向于先得到重调度。

